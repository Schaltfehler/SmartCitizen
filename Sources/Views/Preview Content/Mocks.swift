import Foundation
import SwiftUI
import Combine
import Models
import Network
import Domain

extension Client {
    static func mocked(width data: Data) -> Client {
        Client(networking: { (request: URLRequest) -> AnyPublisher<(data: Data, response: URLResponse), Error> in
            Just((data: data, response: URLResponse()))
                .setFailureType(to: Error.self)
                .eraseToAnyPublisher()
        })
    }
}

extension SearchFetcher {
    static func mocked() -> SearchFetcher {
        let data = NSDataAsset(name: "GlobalSearch")!.data
        let apiClient = Client.mocked(width: data)
        let fetcher = SearchFetcher(client: apiClient)

        return fetcher
    }
}

extension DeviceFetcher {
    static func mocked() -> DeviceFetcher {
        let data = NSDataAsset(name: "DeviceResponse")!.data
        let apiClient = Client.mocked(width: data)
        let deviceFetcher = DeviceFetcher(client: apiClient)

        return deviceFetcher
    }
}

extension SensorFetcher {
    static func mocked() -> SensorFetcher {
        let data = NSDataAsset(name: "Readings")!.data
        let apiClient = Client.mocked(width: data)
        let sensorFetcher = SensorFetcher(client: apiClient)
        return sensorFetcher
    }

    static func mockedWithFullDayReadings() -> SensorFetcher {
        let data = FullDayReadings
        let apiClient = Client.mocked(width: data)
        let sensorFetcher = SensorFetcher(client: apiClient)
        return sensorFetcher
    }
}

extension FavoritesStore {
    static func mocked(_ device: [DevicePreviewModel]) -> FavoritesStore {
        FavoritesStore(load: { device }, save: { _ in /* no-op */})
    }
}

extension WorldMapFetcher {
    static func mocked() -> WorldMapFetcher {
        let data = NSDataAsset(name: "WorldDevices")!.data
        let apiClient = Client.mocked(width: data)
        let fetcher = WorldMapFetcher(client: apiClient)
        return fetcher
    }
}


extension SensorModel {
    static var mocked: SensorModel {
        SensorModel(name: "My Sensor", device_id: 1, sensor_id: 2, type: MeasurementType.co2, unit: "co2")
    }
}


extension SensorFetcher {

    static var FullDayReadings: Data {
"""
{
    "device_id": 10682,
    "sensor_key": "pm_avg_2.5",
    "sensor_id": 87,
    "component_id": 245,
    "rollup": "1m",
    "function": "avg",
    "from": "2023-05-11T07:00:00Z",
    "to": "2023-05-11T10:02:00Z",
    "sample_size": 178,
    "readings":
    [
        [
            "2023-05-11T10:01:15Z",
            4
        ],
        [
            "2023-05-11T10:00:15Z",
            11
        ],
        [
            "2023-05-11T09:59:15Z",
            10
        ],
        [
            "2023-05-11T09:58:15Z",
            8
        ],
        [
            "2023-05-11T09:57:15Z",
            6
        ],
        [
            "2023-05-11T09:56:15Z",
            10
        ],
        [
            "2023-05-11T09:55:15Z",
            8
        ],
        [
            "2023-05-11T09:54:15Z",
            10
        ],
        [
            "2023-05-11T09:53:15Z",
            9
        ],
        [
            "2023-05-11T09:52:15Z",
            10
        ],
        [
            "2023-05-11T09:51:15Z",
            11
        ],
        [
            "2023-05-11T09:50:15Z",
            9
        ],
        [
            "2023-05-11T09:49:15Z",
            6
        ],
        [
            "2023-05-11T09:48:13Z",
            11
        ],
        [
            "2023-05-11T09:47:13Z",
            12
        ],
        [
            "2023-05-11T09:46:13Z",
            8
        ],
        [
            "2023-05-11T09:45:13Z",
            9
        ],
        [
            "2023-05-11T09:44:13Z",
            11
        ],
        [
            "2023-05-11T09:43:13Z",
            8
        ],
        [
            "2023-05-11T09:42:13Z",
            8
        ],
        [
            "2023-05-11T09:41:13Z",
            9
        ],
        [
            "2023-05-11T09:40:13Z",
            10
        ],
        [
            "2023-05-11T09:39:13Z",
            11
        ],
        [
            "2023-05-11T09:38:13Z",
            9
        ],
        [
            "2023-05-11T09:37:13Z",
            11
        ],
        [
            "2023-05-11T09:36:13Z",
            10
        ],
        [
            "2023-05-11T09:35:09Z",
            9
        ],
        [
            "2023-05-11T09:34:08Z",
            4
        ],
        [
            "2023-05-11T09:33:08Z",
            9
        ],
        [
            "2023-05-11T09:32:08Z",
            9
        ],
        [
            "2023-05-11T09:31:08Z",
            7
        ],
        [
            "2023-05-11T09:30:08Z",
            9
        ],
        [
            "2023-05-11T09:29:08Z",
            7
        ],
        [
            "2023-05-11T09:28:08Z",
            10
        ],
        [
            "2023-05-11T09:27:08Z",
            5
        ],
        [
            "2023-05-11T09:26:08Z",
            10
        ],
        [
            "2023-05-11T09:25:08Z",
            6
        ],
        [
            "2023-05-11T09:24:08Z",
            9
        ],
        [
            "2023-05-11T09:23:08Z",
            9
        ],
        [
            "2023-05-11T09:22:06Z",
            9
        ],
        [
            "2023-05-11T09:21:06Z",
            8
        ],
        [
            "2023-05-11T09:20:06Z",
            6
        ],
        [
            "2023-05-11T09:19:06Z",
            10
        ],
        [
            "2023-05-11T09:18:06Z",
            9
        ],
        [
            "2023-05-11T09:17:06Z",
            10
        ],
        [
            "2023-05-11T09:16:06Z",
            10
        ],
        [
            "2023-05-11T09:15:06Z",
            10
        ],
        [
            "2023-05-11T09:14:06Z",
            10
        ],
        [
            "2023-05-11T09:13:06Z",
            9
        ],
        [
            "2023-05-11T09:12:06Z",
            9
        ],
        [
            "2023-05-11T09:11:06Z",
            6
        ],
        [
            "2023-05-11T09:10:06Z",
            8
        ],
        [
            "2023-05-11T09:09:06Z",
            9
        ],
        [
            "2023-05-11T09:08:02Z",
            9
        ],
        [
            "2023-05-11T09:07:01Z",
            7
        ],
        [
            "2023-05-11T09:06:01Z",
            9
        ],
        [
            "2023-05-11T09:05:01Z",
            9
        ],
        [
            "2023-05-11T09:04:01Z",
            10
        ],
        [
            "2023-05-11T09:03:01Z",
            11
        ],
        [
            "2023-05-11T09:02:01Z",
            10
        ],
        [
            "2023-05-11T09:01:01Z",
            11
        ],
        [
            "2023-05-11T09:00:01Z",
            10
        ],
        [
            "2023-05-11T08:59:01Z",
            10
        ],
        [
            "2023-05-11T08:58:01Z",
            9
        ],
        [
            "2023-05-11T08:57:01Z",
            14
        ],
        [
            "2023-05-11T08:56:01Z",
            11
        ],
        [
            "2023-05-11T08:54:57Z",
            9
        ],
        [
            "2023-05-11T08:53:55Z",
            13
        ],
        [
            "2023-05-11T08:52:55Z",
            12
        ],
        [
            "2023-05-11T08:51:55Z",
            13
        ],
        [
            "2023-05-11T08:50:55Z",
            11
        ],
        [
            "2023-05-11T08:49:55Z",
            9
        ],
        [
            "2023-05-11T08:48:55Z",
            11
        ],
        [
            "2023-05-11T08:47:55Z",
            15
        ],
        [
            "2023-05-11T08:46:55Z",
            14
        ],
        [
            "2023-05-11T08:45:55Z",
            13
        ],
        [
            "2023-05-11T08:44:55Z",
            18
        ],
        [
            "2023-05-11T08:43:55Z",
            21
        ],
        [
            "2023-05-11T08:42:55Z",
            15
        ],
        [
            "2023-05-11T08:41:55Z",
            19
        ],
        [
            "2023-05-11T08:40:51Z",
            11
        ],
        [
            "2023-05-11T08:39:50Z",
            19
        ],
        [
            "2023-05-11T08:38:50Z",
            19
        ],
        [
            "2023-05-11T08:37:50Z",
            14
        ],
        [
            "2023-05-11T08:36:50Z",
            7
        ],
        [
            "2023-05-11T08:35:50Z",
            14
        ],
        [
            "2023-05-11T08:34:50Z",
            12
        ],
        [
            "2023-05-11T08:33:50Z",
            14
        ],
        [
            "2023-05-11T08:32:50Z",
            12
        ],
        [
            "2023-05-11T08:31:50Z",
            13
        ],
        [
            "2023-05-11T08:30:50Z",
            14
        ],
        [
            "2023-05-11T08:29:50Z",
            15
        ],
        [
            "2023-05-11T08:28:50Z",
            13
        ],
        [
            "2023-05-11T08:27:48Z",
            14
        ],
        [
            "2023-05-11T08:26:48Z",
            15
        ],
        [
            "2023-05-11T08:25:48Z",
            16
        ],
        [
            "2023-05-11T08:24:48Z",
            14
        ],
        [
            "2023-05-11T08:23:48Z",
            19
        ],
        [
            "2023-05-11T08:22:48Z",
            15
        ],
        [
            "2023-05-11T08:21:48Z",
            14
        ],
        [
            "2023-05-11T08:20:48Z",
            20
        ],
        [
            "2023-05-11T08:19:48Z",
            17
        ],
        [
            "2023-05-11T08:18:48Z",
            14
        ],
        [
            "2023-05-11T08:17:48Z",
            17
        ],
        [
            "2023-05-11T08:16:48Z",
            22
        ],
        [
            "2023-05-11T08:14:37Z",
            23
        ],
        [
            "2023-05-11T08:13:37Z",
            16
        ],
        [
            "2023-05-11T08:12:33Z",
            17
        ],
        [
            "2023-05-11T08:11:32Z",
            16
        ],
        [
            "2023-05-11T08:10:32Z",
            15
        ],
        [
            "2023-05-11T08:09:32Z",
            19
        ],
        [
            "2023-05-11T08:08:32Z",
            18
        ],
        [
            "2023-05-11T08:07:32Z",
            17
        ],
        [
            "2023-05-11T08:06:32Z",
            12
        ],
        [
            "2023-05-11T08:05:32Z",
            20
        ],
        [
            "2023-05-11T08:04:32Z",
            15
        ],
        [
            "2023-05-11T08:03:32Z",
            16
        ],
        [
            "2023-05-11T08:02:32Z",
            20
        ],
        [
            "2023-05-11T08:01:32Z",
            19
        ],
        [
            "2023-05-11T08:00:32Z",
            19
        ],
        [
            "2023-05-11T07:59:32Z",
            18
        ],
        [
            "2023-05-11T07:58:32Z",
            19
        ],
        [
            "2023-05-11T07:57:28Z",
            19
        ],
        [
            "2023-05-11T07:56:26Z",
            19
        ],
        [
            "2023-05-11T07:55:26Z",
            14
        ],
        [
            "2023-05-11T07:54:26Z",
            18
        ],
        [
            "2023-05-11T07:53:26Z",
            16
        ],
        [
            "2023-05-11T07:52:26Z",
            20
        ],
        [
            "2023-05-11T07:51:26Z",
            19
        ],
        [
            "2023-05-11T07:50:26Z",
            17
        ],
        [
            "2023-05-11T07:49:26Z",
            22
        ],
        [
            "2023-05-11T07:48:26Z",
            21
        ],
        [
            "2023-05-11T07:47:26Z",
            19
        ],
        [
            "2023-05-11T07:46:26Z",
            16
        ],
        [
            "2023-05-11T07:45:26Z",
            19
        ],
        [
            "2023-05-11T07:44:26Z",
            18
        ],
        [
            "2023-05-11T07:43:23Z",
            21
        ],
        [
            "2023-05-11T07:42:23Z",
            21
        ],
        [
            "2023-05-11T07:41:23Z",
            16
        ],
        [
            "2023-05-11T07:40:23Z",
            14
        ],
        [
            "2023-05-11T07:39:23Z",
            15
        ],
        [
            "2023-05-11T07:38:23Z",
            14
        ],
        [
            "2023-05-11T07:37:23Z",
            17
        ],
        [
            "2023-05-11T07:36:23Z",
            16
        ],
        [
            "2023-05-11T07:35:23Z",
            16
        ],
        [
            "2023-05-11T07:34:23Z",
            14
        ],
        [
            "2023-05-11T07:33:23Z",
            15
        ],
        [
            "2023-05-11T07:32:23Z",
            18
        ],
        [
            "2023-05-11T07:31:23Z",
            16
        ],
        [
            "2023-05-11T07:29:07Z",
            17
        ],
        [
            "2023-05-11T07:28:07Z",
            18
        ],
        [
            "2023-05-11T07:26:06Z",
            19
        ],
        [
            "2023-05-11T07:25:06Z",
            20
        ],
        [
            "2023-05-11T07:24:06Z",
            18
        ],
        [
            "2023-05-11T07:23:06Z",
            19
        ],
        [
            "2023-05-11T07:22:06Z",
            17
        ],
        [
            "2023-05-11T07:21:06Z",
            19
        ],
        [
            "2023-05-11T07:20:06Z",
            23
        ],
        [
            "2023-05-11T07:19:06Z",
            22
        ],
        [
            "2023-05-11T07:18:06Z",
            18
        ],
        [
            "2023-05-11T07:17:06Z",
            20
        ],
        [
            "2023-05-11T07:16:06Z",
            31
        ],
        [
            "2023-05-11T07:15:06Z",
            25
        ],
        [
            "2023-05-11T07:14:06Z",
            25
        ],
        [
            "2023-05-11T07:13:02Z",
            19
        ],
        [
            "2023-05-11T07:12:01Z",
            15
        ],
        [
            "2023-05-11T07:11:01Z",
            18
        ],
        [
            "2023-05-11T07:10:01Z",
            17
        ],
        [
            "2023-05-11T07:09:01Z",
            20
        ],
        [
            "2023-05-11T07:08:01Z",
            22
        ],
        [
            "2023-05-11T07:07:01Z",
            18
        ],
        [
            "2023-05-11T07:06:01Z",
            20
        ],
        [
            "2023-05-11T07:05:01Z",
            20
        ],
        [
            "2023-05-11T07:04:01Z",
            19
        ],
        [
            "2023-05-11T07:03:01Z",
            18
        ],
        [
            "2023-05-11T07:02:01Z",
            16
        ],
        [
            "2023-05-11T07:01:01Z",
            18
        ],
        [
            "2023-05-11T07:00:01Z",
            19
        ]
    ]
}
""".data(using: .utf8)!
    }

}
